(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aabbaa02"],{"1b44":function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return r})),n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f}));var a=n("b775");function i(e){return Object(a["a"])({url:"/chain/list",method:"get",params:e})}function l(e){return Object(a["a"])({url:"/chain/get",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/chain/add",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/chain/update",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/chain/delete",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/chain/build",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/chain/run",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/chain/stop",method:"post",data:e})}function h(e){return Object(a["a"])({url:"/chain/release",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/chain/podsQuery?chainId="+e,method:"get"})}function p(e){return Object(a["a"])({url:"/chain/changeSize",method:"post",data:e})}function f(e){var t=document.createElement("a");return t.href="/api/chain/download?chainId="+e,t.click(),!0}},"1fc8":function(e,t,n){},"31f0":function(e,t,n){},"6dfa":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return r}));var a=n("b775");function i(e){return Object(a["a"])({url:"/channel/get",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/channel/allList",method:"get",params:{chainId:e}})}function r(e){return Object(a["a"])({url:"/channel/add",method:"post",data:e})}},"7c23":function(e,t,n){"use strict";n("1fc8")},b3c9:function(e,t,n){"use strict";n("b83e")},b83e:function(e,t,n){},bfba:function(e,t,n){"use strict";n("c155")},c155:function(e,t,n){},cd1d:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mixin-components-container"},[n("sticky",{attrs:{"class-name":"sub-navbar default"}},[n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"success"},on:{click:e.exportChain}},[e._v("\n      "+e._s(e.$t("button.export"))+"\n    ")])],1),e._v(" "),n("el-collapse",{staticStyle:{padding:"10px"}},e._l(e.chainPods,(function(t){return n("div",{key:t.name},[n("el-collapse-item",[n("template",{slot:"title"},[n("div",{staticStyle:{padding:"10px","font-size":"15px"}},["Running"==t.status?n("i",{staticClass:"header-icon el-icon-success",staticStyle:{color:"greenyellow"}}):e._e(),e._v(" "),"Running"!=t.status?n("i",{staticClass:"header-icon el-icon-error",staticStyle:{color:"red"}}):e._e(),e._v("\n            "+e._s(t.name)+"\n          ")])]),e._v(" "),n("div",{staticStyle:{padding:"10px","font-size":"15px"}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("div",[e._v("状态: "+e._s(t.status))])]),e._v(" "),n("el-col",{attrs:{span:8}},[n("div",[e._v("类型: "+e._s(t.type))])]),e._v(" "),n("el-col",{attrs:{span:8}},[n("div",[e._v("创建时间："+e._s(t.createTime))])])],1)],1),e._v(" "),n("div",{staticStyle:{padding:"10px","font-size":"15px"}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("div",[e._v("IP："+e._s(t.hostIP))])]),e._v(" "),n("el-col",{attrs:{span:8}},[n("div",[e._v("端口："+e._s(t.port))])])],1)],1),e._v(" "),n("div",{staticStyle:{padding:"10px",border:"1px solid #DCDFE6","border-radius":"4px",color:"red","text-align":"center","font-size":"15px"}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("div",[e._v("CPU："+e._s(t.cpu))])]),e._v(" "),n("el-col",{attrs:{span:8}},[n("div",[e._v("内存："+e._s(t.memory)+"Mi")])]),e._v(" "),n("el-col",{attrs:{span:8}},[n("div",[n("el-button",{attrs:{type:"primary",plain:""},on:{click:function(n){return e.handleChangeSize(t.name,t.cpu,t.memory)}}},[e._v(e._s(e.$t("button.changeSize")))])],1)])],1)],1)],2)],1)})),0),e._v(" "),n("el-row",{staticClass:"channelbody",attrs:{gutter:20}},[e._l(e.channels,(function(t){return n("div",{key:t.id},[n("el-col",{attrs:{span:6}},[n("el-card",{staticStyle:{margin:"6px"}},[n("el-container",{staticStyle:{height:"180px"}},[n("el-aside",{staticStyle:{width:"100px",background:"white"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-news",circle:""}})],1),e._v(" "),n("el-main",{staticStyle:{margin:"-12px -30px"}},[n("div",[n("span",{staticStyle:{"font-size":"30px"}},[e._v(e._s(t.channelName))]),e._v(" "),n("div",{staticClass:"bottom clearfix"},[n("time",{staticClass:"time"},[e._v(e._s(e._f("parseTime")(t.created,"{y}-{m}-{d} {h}:{i}")))]),e._v(" "),n("div",{staticStyle:{"margin-top":"20px"}},e._l(t.orgs.split(","),(function(t){return n("el-tag",{key:t,staticStyle:{"margin-right":"5px"},attrs:{"disable-transitions":!1}},[e._v(" "+e._s(t)+" ")])})),1)]),e._v(" "),n("router-link",{attrs:{to:"/baas/chaincode/"+t.id}},[n("el-button",{staticClass:"button",attrs:{type:"text"}},[e._v(e._s(e.$t("button.see")))])],1)],1)])],1)],1)],1)],1)})),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-card",{staticClass:"box-card card"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogFormVisible,expression:"dialogFormVisible"}],staticStyle:{height:"180px"}},[n("el-form",{ref:"dataForm",attrs:{model:e.channel,rules:e.channelRules}},[n("el-form-item",{attrs:{prop:"channelName"}},[n("md-input",{attrs:{name:"channelName",placeholder:"输入通道名"},model:{value:e.channel.channelName,callback:function(t){e.$set(e.channel,"channelName",t)},expression:"channel.channelName"}},[e._v("\n                "+e._s(e.$t("channel.channelName"))+"\n              ")])],1),e._v(" "),n("el-form-item",{attrs:{prop:"orgs"}},[n("el-drag-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择组织"},model:{value:e.orgs,callback:function(t){e.orgs=t},expression:"orgs"}},e._l(e.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),n("div",{staticClass:"bottom clearfix"},[n("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(t){return e.createData()}}},[e._v(e._s(e.$t("button.add")))])],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.dialogFormVisible,expression:"!dialogFormVisible"}],staticClass:"passbutton"},[n("a",{on:{click:function(t){return e.handleCreate()}}},[n("i",{staticClass:"el-icon-circle-plus-outline"})])])])],1)],2),e._v(" "),n("el-dialog",{attrs:{title:e.node,visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[n("el-form",{ref:"dataForm2",staticStyle:{width:"500px","margin-left":"50px"},attrs:{model:e.channel,"label-position":"left","label-width":"70px"}},[n("el-form-item",{attrs:{label:e.$t("resource.cpu")}},[n("el-slider",{attrs:{step:.25,max:e.maxCpu,"show-stops":"","show-input":""},model:{value:e.cpu,callback:function(t){e.cpu=t},expression:"cpu"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("resource.memory")}},[n("el-slider",{attrs:{step:256,max:e.maxMemory,"show-stops":"","show-input":""},model:{value:e.memory,callback:function(t){e.memory=t},expression:"memory"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("\n        "+e._s(e.$t("button.cancel"))+"\n      ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changeSize()}}},[e._v("\n        "+e._s(e.$t("button.confirm"))+"\n      ")])],1)],1)],1)},i=[],l=(n("ac6a"),n("28a5"),n("c5f6"),n("db72")),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"material-input__component",class:e.computedClasses},[n("div",{class:{iconClass:e.icon}},[e.icon?n("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),e._v(" "),"email"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"url"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"number"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"password"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"tel"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"text"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),n("span",{staticClass:"material-input-bar"}),e._v(" "),n("label",{staticClass:"material-label"},[e._t("default")],2)])])},s=[],o={name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}},c=o,u=(n("bfba"),n("2877")),d=Object(u["a"])(c,r,s,!1,null,"6d11c605",null),h=d.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[n("div",{class:e.className,style:{top:e.isSticky?e.stickyTop+"px":"",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[n("div",[e._v("sticky")])])],2)])},p=[],f={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var e=this.$el.getBoundingClientRect().width;this.width=e||"auto";var t=this.$el.getBoundingClientRect().top;t<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},v=f,g=Object(u["a"])(v,m,p,!1,null,null,null),b=g.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",e._g(e._b({ref:"dragSelect",staticClass:"drag-select",attrs:{multiple:""},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}},"el-select",e.$attrs,!1),e.$listeners),[e._t("default")],2)},_=[],x=n("75fc"),C=n("53fe"),w=n.n(C),S={name:"DragSelect",props:{value:{type:Array,required:!0}},computed:{selectVal:{get:function(){return Object(x["a"])(this.value)},set:function(e){this.$emit("input",Object(x["a"])(e))}}},mounted:function(){this.setSort()},methods:{setSort:function(){var e=this,t=this.$refs.dragSelect.$el.querySelectorAll(".el-select__tags > span")[0];this.sortable=w.a.create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){var n=e.value.splice(t.oldIndex,1)[0];e.value.splice(t.newIndex,0,n)}})}}},V=S,$=(n("ef96"),Object(u["a"])(V,y,_,!1,null,"46cab54a",null)),k=$.exports,I=n("1b44"),O=n("6dfa"),j=n("2f62"),N=n("ed08"),F={},M={name:"Channel",components:{MdInput:h,ElDragSelect:k,Sticky:b},data:function(){F=this;var e=setInterval((function(){var t=sessionStorage.getItem("ROUTE_PATH");0!==t.indexOf("/baas/channel")&&clearInterval(e),Object(I["h"])(F.chainId).then((function(e){0===e.code&&(F.chainPods=e.data)}))}),1e4);return{chainId:0,channel:{chainId:0,orgs:"",channelName:"",userAccount:void 0},chain:{id:0,userAccount:""},memory:0,cpu:0,maxMemory:2048,maxCpu:2,node:"",chainPods:[],channelRules:{channelName:[{required:!0,message:"channelName is required",trigger:"blur"}],orgs:[{required:!0,message:"orgs is required",trigger:"blur"}]},options:[],orgs:[],channels:[],loading:!1,dialogFormVisible:!1,dialogFormVisible2:!1,fullscreenLoading:!1}},computed:Object(l["a"])({},Object(j["b"])(["account"])),created:function(){var e=this.$route.params&&this.$route.params.id;this.chainId=Number(e),this.getChain(),this.getAllChannel()},methods:{getChain:function(){var e=this;this.chain.id=this.chainId,this.chain.userAccount=this.account,Object(I["f"])(this.chain).then((function(t){if(0===t.code){var n=t.data.peersOrgs.split(",");n.forEach((function(t){var n={value:t,label:t};e.options.push(n)}))}})),Object(I["h"])(this.chainId).then((function(t){0===t.code&&(e.chainPods=t.data)}))},getAllChannel:function(){var e=this;Object(O["c"])(this.chainId).then((function(t){0===t.code&&(e.channels=t.data)}))},exportChain:function(){this.loading=!0,Object(I["e"])(this.chainId)&&(this.loading=!1)},handleCreate:function(){var e=this;this.reset(),this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},createData:function(){var e=this,t=this.$loading({lock:!0,target:".channelbody"});this.dialogFormVisible=!1,this.channel.userAccount=this.account,this.channel.chainId=this.chainId,this.channel.orgs=this.orgs.join(","),this.$refs["dataForm"].validate((function(n){n&&Object(O["a"])(e.channel).then((function(){e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.getAllChannel(),t.close()}))}))},handleChangeSize:function(e,t,n){var a=this;this.dialogFormVisible2=!0,this.node=e,this.cpu=Number(t),this.memory=Number(n),this.$nextTick((function(){a.$refs["dataForm2"].clearValidate()}))},changeSize:function(){var e=this,t={node:this.node,cpu:this.cpu,memory:this.memory};Object(I["c"])(t).then((function(){e.$notify({title:"成功",message:"改变规格成功",type:"success",duration:2e3}),e.dialogFormVisible2=!1}))},reset:function(){this.orgs=[],this.channel={chainId:0,orgs:"",channelName:"",userAccount:void 0}},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?Object(N["e"])(t[e]):t[e]}))}))}}},P=M,z=(n("b3c9"),n("7c23"),Object(u["a"])(P,a,i,!1,null,"41b18e1e",null));t["default"]=z.exports},ef96:function(e,t,n){"use strict";n("31f0")}}]);